     1                                  BOOT_LOAD equ 0x7C00		;ÉuÅ[ÉgÉvÉçÉOÉâÉÄÇÃÉçÅ[Éhà íu
     2                                  
     3                                  ORG BOOT_LOAD			;ÉçÅ[ÉhÉAÉhÉåÉXÇÉAÉZÉìÉuÉâÇ…éwé¶ (1ìxÇµÇ©éwé¶Ç≈Ç´Ç»Ç¢)
     4                                  
     5                                  ;------------------------
     6                                  ;ÅyÉ}ÉNÉçÅz
     7                                  ;------------------------
     8                                  %include "..\include\macro.s"
     1                              <1> %macro cdecl 1-*.noilst
     2                              <1> 
     3                              <1>         %rep %0 - 1
     4                              <1>             push %{-1:-1}
     5                              <1>             %rotate -1
     6                              <1>         %endrep
     7                              <1>         %rotate -1
     8                              <1>         call %1
     9                              <1> 
    10                              <1>     %if 1 < %0
    11                              <1>         add sp,(__BITS__ >> 3) * (%0 -1)
    12                              <1>     %endif
    13                              <1> 
    14                              <1> %endmacro
     9                                  
    10                                  ;****************************************************
    11                                  ;ÅyÉGÉìÉgÉäÉ|ÉCÉìÉgÅz
    12                                  ;****************************************************
    13                                  
    14                                  entry:
    15                                  
    16                                  
    17                                  ;----------------------------
    18                                  ;ÅyBPB(BIOS Parameter Block)Åz
    19                                  ;----------------------------
    20 00000000 EB58                    jmp	ipl		;IPLÇ÷ÉWÉÉÉìÉv
    21 00000002 90<rept>                times 90 - ($ - $$) db 0x90
    22                                  
    23                                  
    24                                  ;----------------------------
    25                                  ;ÅyIPL(Initial Program Loader)Åz
    26                                  ;----------------------------
    27                                  ipl:
    28 0000005A FA                      	cli			;äÑÇËçûÇ›èàóùÇ…ç°ÇÕëŒâûÇµÇƒÇ¢Ç»Ç¢ÇÃÇ≈ÅAäÑÇËçûÇ›èàóùÇã÷é~Ç…Ç∑ÇÈ
    29                                  	
    30 0000005B B80000                  	mov ax,0x0000		;AX = 0x0000
    31 0000005E 8ED8                    	mov ds,ax		;DS = 0x0000
    32 00000060 8EC0                    	mov es,ax		;ES = 0x0000
    33 00000062 8ED0                    	mov ss,ax		;SS = 0x0000
    34 00000064 BC007C                  	mov sp,BOOT_LOAD	;SP = 0x7C00
    35                                  
    36 00000067 FB                      	sti			;äÑÇËçûÇ›ãñâ¬
    37                                  
    38 00000068 8816[4801]              	mov [BOOT.DRIVE],dl	;ÉuÅ[ÉgÉhÉâÉCÉuÇï€ë∂
    39                                  	
    40                                  	;----------------
    41                                  	;ï∂éöóÒÇï\é¶
    42                                  	;----------------
    43                                  	cdecl puts,.s0		;puts(.s0)
    43                              <1> 
    43                              <1>  %rep %0 - 1
    43                              <1>  push %-1:-1
    43                              <1>  %rotate -1
    43                              <1>  %endrep
    43 0000006C 68[3001]            <2>  push %-1:-1
    43                              <2>  %rotate -1
    43                              <1>  %rotate -1
    43 0000006F E8D800              <1>  call %1
    43                              <1> 
    43                              <1>  %if 1 < %0
    43 00000072 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    43                              <1>  %endif
    43                              <1> 
    44                                  	
    45                                  	;----------------
    46                                  	;êîílÇï\é¶
    47                                  	;----------------
    48                                  	cdecl itoa, 8086, .s1, 8, 10, 0b0001 ;"	8086"
    48                              <1> 
    48                              <1>  %rep %0 - 1
    48                              <1>  push %-1:-1
    48                              <1>  %rotate -1
    48                              <1>  %endrep
    48 00000075 6A01                <2>  push %-1:-1
    48                              <2>  %rotate -1
    48 00000077 6A0A                <2>  push %-1:-1
    48                              <2>  %rotate -1
    48 00000079 6A08                <2>  push %-1:-1
    48                              <2>  %rotate -1
    48 0000007B 68[3D01]            <2>  push %-1:-1
    48                              <2>  %rotate -1
    48 0000007E 68961F              <2>  push %-1:-1
    48                              <2>  %rotate -1
    48                              <1>  %rotate -1
    48 00000081 E8E500              <1>  call %1
    48                              <1> 
    48                              <1>  %if 1 < %0
    48 00000084 83C40A              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    48                              <1>  %endif
    48                              <1> 
    49                                  	cdecl puts, .s1
    49                              <1> 
    49                              <1>  %rep %0 - 1
    49                              <1>  push %-1:-1
    49                              <1>  %rotate -1
    49                              <1>  %endrep
    49 00000087 68[3D01]            <2>  push %-1:-1
    49                              <2>  %rotate -1
    49                              <1>  %rotate -1
    49 0000008A E8BD00              <1>  call %1
    49                              <1> 
    49                              <1>  %if 1 < %0
    49 0000008D 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    49                              <1>  %endif
    49                              <1> 
    50                                  
    51                                  	cdecl itoa, 8086, .s1, 8, 10, 0b0011 ;"+8086"
    51                              <1> 
    51                              <1>  %rep %0 - 1
    51                              <1>  push %-1:-1
    51                              <1>  %rotate -1
    51                              <1>  %endrep
    51 00000090 6A03                <2>  push %-1:-1
    51                              <2>  %rotate -1
    51 00000092 6A0A                <2>  push %-1:-1
    51                              <2>  %rotate -1
    51 00000094 6A08                <2>  push %-1:-1
    51                              <2>  %rotate -1
    51 00000096 68[3D01]            <2>  push %-1:-1
    51                              <2>  %rotate -1
    51 00000099 68961F              <2>  push %-1:-1
    51                              <2>  %rotate -1
    51                              <1>  %rotate -1
    51 0000009C E8CA00              <1>  call %1
    51                              <1> 
    51                              <1>  %if 1 < %0
    51 0000009F 83C40A              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    51                              <1>  %endif
    51                              <1> 
    52                                  	cdecl puts, .s1
    52                              <1> 
    52                              <1>  %rep %0 - 1
    52                              <1>  push %-1:-1
    52                              <1>  %rotate -1
    52                              <1>  %endrep
    52 000000A2 68[3D01]            <2>  push %-1:-1
    52                              <2>  %rotate -1
    52                              <1>  %rotate -1
    52 000000A5 E8A200              <1>  call %1
    52                              <1> 
    52                              <1>  %if 1 < %0
    52 000000A8 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    52                              <1>  %endif
    52                              <1> 
    53                                  
    54                                  	cdecl itoa, -8086, .s1, 8, 10, 0b0001 ;"-8086"
    54                              <1> 
    54                              <1>  %rep %0 - 1
    54                              <1>  push %-1:-1
    54                              <1>  %rotate -1
    54                              <1>  %endrep
    54 000000AB 6A01                <2>  push %-1:-1
    54                              <2>  %rotate -1
    54 000000AD 6A0A                <2>  push %-1:-1
    54                              <2>  %rotate -1
    54 000000AF 6A08                <2>  push %-1:-1
    54                              <2>  %rotate -1
    54 000000B1 68[3D01]            <2>  push %-1:-1
    54                              <2>  %rotate -1
    54 000000B4 686AE0              <2>  push %-1:-1
    54                              <2>  %rotate -1
    54                              <1>  %rotate -1
    54 000000B7 E8AF00              <1>  call %1
    54                              <1> 
    54                              <1>  %if 1 < %0
    54 000000BA 83C40A              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    54                              <1>  %endif
    54                              <1> 
    55                                  	cdecl puts, .s1
    55                              <1> 
    55                              <1>  %rep %0 - 1
    55                              <1>  push %-1:-1
    55                              <1>  %rotate -1
    55                              <1>  %endrep
    55 000000BD 68[3D01]            <2>  push %-1:-1
    55                              <2>  %rotate -1
    55                              <1>  %rotate -1
    55 000000C0 E88700              <1>  call %1
    55                              <1> 
    55                              <1>  %if 1 < %0
    55 000000C3 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    55                              <1>  %endif
    55                              <1> 
    56                                  
    57                                  	cdecl itoa, -1, .s1, 8, 10, 0b0001 ;"- 1"
    57                              <1> 
    57                              <1>  %rep %0 - 1
    57                              <1>  push %-1:-1
    57                              <1>  %rotate -1
    57                              <1>  %endrep
    57 000000C6 6A01                <2>  push %-1:-1
    57                              <2>  %rotate -1
    57 000000C8 6A0A                <2>  push %-1:-1
    57                              <2>  %rotate -1
    57 000000CA 6A08                <2>  push %-1:-1
    57                              <2>  %rotate -1
    57 000000CC 68[3D01]            <2>  push %-1:-1
    57                              <2>  %rotate -1
    57 000000CF 6AFF                <2>  push %-1:-1
    57                              <2>  %rotate -1
    57                              <1>  %rotate -1
    57 000000D1 E89500              <1>  call %1
    57                              <1> 
    57                              <1>  %if 1 < %0
    57 000000D4 83C40A              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    57                              <1>  %endif
    57                              <1> 
    58                                  	cdecl puts, .s1
    58                              <1> 
    58                              <1>  %rep %0 - 1
    58                              <1>  push %-1:-1
    58                              <1>  %rotate -1
    58                              <1>  %endrep
    58 000000D7 68[3D01]            <2>  push %-1:-1
    58                              <2>  %rotate -1
    58                              <1>  %rotate -1
    58 000000DA E86D00              <1>  call %1
    58                              <1> 
    58                              <1>  %if 1 < %0
    58 000000DD 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    58                              <1>  %endif
    58                              <1> 
    59                                  
    60                                  	cdecl itoa, -1, .s1, 8, 10, 0b0000 ;"	8086"
    60                              <1> 
    60                              <1>  %rep %0 - 1
    60                              <1>  push %-1:-1
    60                              <1>  %rotate -1
    60                              <1>  %endrep
    60 000000E0 6A00                <2>  push %-1:-1
    60                              <2>  %rotate -1
    60 000000E2 6A0A                <2>  push %-1:-1
    60                              <2>  %rotate -1
    60 000000E4 6A08                <2>  push %-1:-1
    60                              <2>  %rotate -1
    60 000000E6 68[3D01]            <2>  push %-1:-1
    60                              <2>  %rotate -1
    60 000000E9 6AFF                <2>  push %-1:-1
    60                              <2>  %rotate -1
    60                              <1>  %rotate -1
    60 000000EB E87B00              <1>  call %1
    60                              <1> 
    60                              <1>  %if 1 < %0
    60 000000EE 83C40A              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    60                              <1>  %endif
    60                              <1> 
    61                                  	cdecl puts, .s1
    61                              <1> 
    61                              <1>  %rep %0 - 1
    61                              <1>  push %-1:-1
    61                              <1>  %rotate -1
    61                              <1>  %endrep
    61 000000F1 68[3D01]            <2>  push %-1:-1
    61                              <2>  %rotate -1
    61                              <1>  %rotate -1
    61 000000F4 E85300              <1>  call %1
    61                              <1> 
    61                              <1>  %if 1 < %0
    61 000000F7 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    61                              <1>  %endif
    61                              <1> 
    62                                  
    63                                  	cdecl itoa, -1, .s1, 8, 16, 0b0000 ;"	8086"
    63                              <1> 
    63                              <1>  %rep %0 - 1
    63                              <1>  push %-1:-1
    63                              <1>  %rotate -1
    63                              <1>  %endrep
    63 000000FA 6A00                <2>  push %-1:-1
    63                              <2>  %rotate -1
    63 000000FC 6A10                <2>  push %-1:-1
    63                              <2>  %rotate -1
    63 000000FE 6A08                <2>  push %-1:-1
    63                              <2>  %rotate -1
    63 00000100 68[3D01]            <2>  push %-1:-1
    63                              <2>  %rotate -1
    63 00000103 6AFF                <2>  push %-1:-1
    63                              <2>  %rotate -1
    63                              <1>  %rotate -1
    63 00000105 E86100              <1>  call %1
    63                              <1> 
    63                              <1>  %if 1 < %0
    63 00000108 83C40A              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    63                              <1>  %endif
    63                              <1> 
    64                                  	cdecl puts, .s1
    64                              <1> 
    64                              <1>  %rep %0 - 1
    64                              <1>  push %-1:-1
    64                              <1>  %rotate -1
    64                              <1>  %endrep
    64 0000010B 68[3D01]            <2>  push %-1:-1
    64                              <2>  %rotate -1
    64                              <1>  %rotate -1
    64 0000010E E83900              <1>  call %1
    64                              <1> 
    64                              <1>  %if 1 < %0
    64 00000111 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    64                              <1>  %endif
    64                              <1> 
    65                                  
    66                                  	cdecl itoa, 12, .s1, 8, 2, 0b0100 ;"	8086"
    66                              <1> 
    66                              <1>  %rep %0 - 1
    66                              <1>  push %-1:-1
    66                              <1>  %rotate -1
    66                              <1>  %endrep
    66 00000114 6A04                <2>  push %-1:-1
    66                              <2>  %rotate -1
    66 00000116 6A02                <2>  push %-1:-1
    66                              <2>  %rotate -1
    66 00000118 6A08                <2>  push %-1:-1
    66                              <2>  %rotate -1
    66 0000011A 68[3D01]            <2>  push %-1:-1
    66                              <2>  %rotate -1
    66 0000011D 6A0C                <2>  push %-1:-1
    66                              <2>  %rotate -1
    66                              <1>  %rotate -1
    66 0000011F E84700              <1>  call %1
    66                              <1> 
    66                              <1>  %if 1 < %0
    66 00000122 83C40A              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    66                              <1>  %endif
    66                              <1> 
    67                                  	cdecl puts, .s1
    67                              <1> 
    67                              <1>  %rep %0 - 1
    67                              <1>  push %-1:-1
    67                              <1>  %rotate -1
    67                              <1>  %endrep
    67 00000125 68[3D01]            <2>  push %-1:-1
    67                              <2>  %rotate -1
    67                              <1>  %rotate -1
    67 00000128 E81F00              <1>  call %1
    67                              <1> 
    67                              <1>  %if 1 < %0
    67 0000012B 83C402              <1>  add sp,(__BITS__ >> 3) * (%0 -1)
    67                              <1>  %endif
    67                              <1> 
    68                                  	
    69                                  	;----------------
    70                                  	;èàóùÇÃèIóπ
    71                                  	;----------------
    72 0000012E EBFE                    	jmp $			;while(1); // ñ≥å¿ÉãÅ[Év
    73                                  
    74                                  ;----------------
    75                                  ;ï∂éöóÒÇÃï\é¶Ç≈ï\é¶Ç∑ÇÈÉfÅ[É^
    76                                  ;----------------
    77 00000130 426F6F74696E672E2E-     .s0	db "Booting...",0x0A,0x0D,0		;//	.s0 = "Booting..." +"0x0A(ÉâÉCÉìÉtÉBÅ[Éh)"+"0x0D(ÉLÉÉÉäÉbÉWÉäÉ^Å[Éì)";
    77 00000139 2E0A0D00           
    78 0000013D 2D2D2D2D2D2D2D2D0A-     .s1 db "--------",0x0A,0x0D,0		;//	.s0 = "----------" +"0x0A(ÉâÉCÉìÉtÉBÅ[Éh)"+"0x0D(ÉLÉÉÉäÉbÉWÉäÉ^Å[Éì)";
    78 00000146 0D00               
    79                                  
    80                                  ALIGN 2,db 0			;ÉfÅ[É^Ç2ÉoÉCÉgã´äEÇ≈îzíuÇ∑ÇÈÇÊÇ§Ç…éwé¶
    81                                  BOOT:				;ÉuÅ[ÉgÉhÉâÉCÉuÇ…ä÷Ç∑ÇÈèÓïÒ
    82 00000148 0000                    .DRIVE:		dw 0		;ÉhÉâÉCÉuî‘çÜ
    83                                  
    84                                  ;------------------------
    85                                  ;ÅyÉÇÉWÉÖÅ[ÉãÅz
    86                                  ;------------------------
    87                                  %include "..\modules\real\puts.s"
     1                              <1> ;************************
     2                              <1> ; void puts(str)
     3                              <1> ;************************
     4                              <1> ; Êàª„ÇäÂÄ§ | „Å™„Åó
     5                              <1> ; str	 | ÊñáÂ≠óÂàó„Ç¢„Éâ„É¨„Çπ
     6                              <1> ;************************
     7                              <1> 
     8                              <1> puts:
     9                              <1> 
    10                              <1> ;------------------------
    11                              <1> ;„Äê„Çπ„Çø„ÉÉ„ÇØ„Éï„É¨„Éº„É†„ÅÆÊßãÁØâ„Äë
    12                              <1> ;------------------------
    13                              <1> ; +4 	 | ÊñáÂ≠óÂàó„Å∏„ÅÆ„Ç¢„Éâ„É¨„Çπ
    14                              <1> ; +2 	 | IP(Êàª„ÇäÁï™Âú∞)
    15                              <1> ; BP + 0 | BP(ÂÖÉ„ÅÆÂÄ§)
    16                              <1> ;--------|------------
    17                              <1> 
    18 0000014A 55                  <1> push bp
    19 0000014B 89E5                <1> mov bp,sp
    20                              <1> 
    21                              <1> ;------------------------
    22                              <1> ;„Äê„É¨„Ç∏„Çπ„Çø„ÅÆ‰øùÂ≠ò„Äë
    23                              <1> ;------------------------
    24 0000014D 50                  <1> push ax
    25 0000014E 53                  <1> push bx
    26 0000014F 56                  <1> push si
    27                              <1> 
    28                              <1> ;------------------------
    29                              <1> ;„ÄêÂºïÊï∞„ÇíÂèñÂæó„Äë
    30                              <1> ;------------------------
    31 00000150 8B7604              <1> mov si,[bp + 4]
    32                              <1> 
    33                              <1> ;------------------------
    34                              <1> ;„ÄêÂá¶ÁêÜ„ÅÆÈñãÂßã„Äë
    35                              <1> ;------------------------
    36 00000153 B40E                <1> mov ah,0x0E
    37 00000155 BB0000              <1> mov bx,0x0000
    38 00000158 FC                  <1> cld         ;DF„Éï„É©„Ç∞„Çí0„Å´Ë®≠ÂÆö„Åó„Å¶„ÄÅ[lodsbÂëΩ‰ª§„ÅÆÊôÇ„Å´]„Ç¢„Éâ„É¨„Çπ„ÇíÂä†ÁÆó
    39                              <1> 
    40                              <1> .10L:       ;do{
    41 00000159 AC                  <1> lodsb       ;   AL = *SI++;
    42 0000015A 3C00                <1> cmp al,0    ;   if(0 == AL)
    43 0000015C 7404                <1> je  .10E    ;       break;
    44 0000015E CD10                <1> int 0x10    ;   Int10(0x0E,AL); // ÊñáÂ≠óÂá∫Âäõ
    45 00000160 EBF7                <1> jmp .10L    ;
    46                              <1> .10E:       ;}while(1);
    47                              <1> ;------------------------
    48                              <1> ;„Äê„É¨„Ç∏„Çπ„Çø„ÅÆÂæ©Â∏∞„Äë
    49                              <1> ;------------------------
    50 00000162 5E                  <1> pop si
    51 00000163 5B                  <1> pop bx
    52 00000164 58                  <1> pop ax
    53                              <1> ;------------------------
    54                              <1> ;„Äê„Çπ„Çø„ÉÉ„ÇØ„Éï„É¨„Éº„É†„ÅÆÁ†¥Ê£Ñ„Äë
    55                              <1> ;------------------------
    56 00000165 89EC                <1> mov sp,bp
    57 00000167 5D                  <1> pop bp
    58                              <1> 
    59 00000168 C3                  <1> ret
    88                                  %include "..\modules\real\itoa.s"
     1                              <1> ;--------------------------------------
     2                              <1> ; void itoa(num,buff,size,radix,flag)
     3                              <1> ;--------------------------------------
     4                              <1> ; Êàª„ÇäÂÄ§ : „Å™„Åó
     5                              <1> ; num    : Â§âÊèõ„Åô„ÇãÂÄ§
     6                              <1> ; buff   : ‰øùÂ≠òÂÖà„Éê„ÉÉ„Éï„Ç°„Ç¢„Éâ„É¨„Çπ
     7                              <1> ; size   : ‰øùÂ≠òÂÖà„Éê„ÉÉ„Éï„Ç°„Çµ„Ç§„Ç∫
     8                              <1> ; radix  : Âü∫Êï∞(2,8,10,16)„ÇíË®≠ÂÆö
     9                              <1> ; flags  : „Éì„ÉÉ„ÉàÂÆöÁæ©„ÅÆ„Éï„É©„Ç∞
    10                              <1> ;        : B2:Á©∫ÁôΩ„Çí'0'„ÅßÂüã„ÇÅ„Çã
    11                              <1> ;        : B1:'+/-'Ë®òÂè∑„Çí‰ªòÂä†„Åô„Çã
    12                              <1> ;        : B0:ÂÄ§„ÇíÁ¨¶Âè∑‰ªò„ÅçÂ§âÊï∞„Å®„Åó„Å¶Êâ±„ÅÜ
    13                              <1> ;--------------------------------------
    14                              <1> 
    15                              <1> itoa:
    16                              <1>     ;-------------------------------------
    17                              <1>     ;„Äê„Çπ„Çø„ÉÉ„ÇØ„Éï„É¨„Éº„É†„ÅÆÊßãÁØâ„Äë
    18                              <1>     ; +12 | „Éï„É©„Ç∞
    19                              <1>     ; +10 | Âü∫Êï∞
    20                              <1>     ; +08 | „Éê„ÉÉ„Éï„Ç°„Çµ„Ç§„Ç∫
    21                              <1>     ; +06 | „Éê„ÉÉ„Éï„Ç°„Ç¢„Éâ„É¨„Çπ
    22                              <1>     ; +04 | Êï∞ÂÄ§
    23                              <1>     ; +02 | IP(Êàª„ÇäÁï™Âú∞)
    24                              <1>     ; BP+0| BP(ÂÖÉ„ÅÆÂÄ§)
    25                              <1>     ;-------------------------------------
    26 00000169 55                  <1>     push bp
    27 0000016A 89E5                <1>     mov bp,sp
    28                              <1> 
    29                              <1>     ;-------------------------------------
    30                              <1>     ;„Äê„É¨„Ç∏„Çπ„Çø„ÅÆ‰øùÂ≠ò„Äë
    31                              <1>     ;-------------------------------------
    32 0000016C 50                  <1>     push ax
    33 0000016D 53                  <1>     push bx
    34 0000016E 51                  <1>     push cx
    35 0000016F 52                  <1>     push dx
    36 00000170 56                  <1>     push si
    37 00000171 57                  <1>     push di
    38                              <1> 
    39                              <1>     ;-------------------------------------
    40                              <1>     ;„ÄêÂºïÊï∞„ÇíÂèñÂæó„Äë
    41                              <1>     ; add : Á¨¨Ôºë„Ç™„Éö„É©„É≥„Éâ„Å´Á¨¨Ôºí„Ç™„Éö„É©„É≥„Éâ„ÇíË∂≥„Åô
    42                              <1>     ; dec : „Ç™„Éö„É©„É≥„Éâ„Åã„Çâ1„ÇíÂºï„Åè
    43                              <1>     ;-------------------------------------
    44 00000172 8B4604              <1>     mov ax,[bp + 4]     ;Êï∞ÂÄ§
    45 00000175 8B7606              <1>     mov si,[bp + 6]     ;„Éê„ÉÉ„Éï„Ç°„Ç¢„Éâ„É¨„Çπ
    46 00000178 8B4E08              <1>     mov cx,[bp + 8]     ;„Éê„ÉÉ„Éï„Ç°„Çµ„Ç§„Ç∫
    47                              <1> 
    48                              <1>     ;------ „Éê„ÉÉ„Éï„Ç°„ÅÆÊúÄÂæåÂ∞æ„ÇíÂèñÂæó ------
    49 0000017B 89F7                <1>     mov di,si           ;di = „Éê„ÉÉ„Éï„Ç°„Ç¢„Éâ„É¨„Çπ
    50 0000017D 01CF                <1>     add di,cx           ;„Éê„ÉÉ„Éï„Ç°„Ç¢„Éâ„É¨„Çπ(di) + „Éê„ÉÉ„Éï„Ç°„Çµ„Ç§„Ç∫(cx)
    51 0000017F 4F                  <1>     dec di              ;„Éê„ÉÉ„Éï„Ç°„Çµ„Ç§„Ç∫ - 1
    52                              <1> 
    53 00000180 8B5E0C              <1>     mov bx,word[bp + 12];flags = „Ç™„Éó„Ç∑„Éß„É≥
    54                              <1>     
    55                              <1> ;-----------------------
    56                              <1> ;„ÄêÁ¨¶Âè∑‰ªò„ÅçÂà§ÂÆö„Äë
    57                              <1> ; je  : ZF = 1
    58                              <1> ; jge : Á¨¶Âè∑‰ªò„ÅçÊºîÁÆó„ÅÆÂ†¥Âêà„ÅÆÂà§ÂÆö
    59                              <1> ;-----------------------
    60                              <1> 
    61 00000183 F7C30100            <1>     test bx,0b0001      ;if(flags & 0x01)   // ÊúÄ‰∏ã‰Ωç„Éì„ÉÉ„Éà„ÇíÊ§úÊüª(Á¨¶Âè∑‰ªò„Åç„ÅÆÂ†¥ÂêàTrue)
    62 00000187 7408                <1> .10Q: je  .10E          ;{
    63 00000189 83F800              <1>     cmp ax,0            ;    if(val < 0)
    64 0000018C 7D03                <1> .12Q: jge .12E          ;    {
    65 0000018E 83CB02              <1>     or bx,0b0010        ;       flags |= 2; //  NEGÂëΩ‰ª§(2„ÅÆË£úÊï∞)Á¨¶Âè∑Ë°®Á§∫
    66                              <1> .12E:                   ;    }
    67                              <1> .10E:                   ;}
    68                              <1> 
    69                              <1> ;------------------------
    70                              <1> ;Á¨¶Âè∑Âá∫ÂäõÂà§ÂÆö
    71                              <1> ;------------------------
    72 00000191 F7C30200            <1>     test bx,0b0010      ;if(flags & 0x02)   //  Á¨¶Âè∑Âá∫ÂäõÂà§ÂÆö
    73 00000195 7410                <1> .20Q: je .20E           ;{
    74 00000197 83F800              <1>     cmp ax,0            ;   if(val < 0)
    75 0000019A 7D07                <1> .22Q: jge .22F          ;   {
    76 0000019C F7D8                <1>     neg ax              ;       val *= -1;  //  Á¨¶Âè∑ÂèçËª¢
    77 0000019E C6042D              <1>     mov [si],byte'-'    ;       *dst ='-';  //  Á¨¶Âè∑Ë°®Á§∫
    78 000001A1 EB03                <1>     jmp .22E            ;   }
    79                              <1> .22F:                   ;   else{
    80 000001A3 C6042B              <1>     mov [si],byte'+'    ;       *dst='+';  //  Á¨¶Âè∑Ë°®Á§∫
    81                              <1> .22E:                   ;   }
    82 000001A6 49                  <1>     dec cx              ;   size-;             //  ÊÆã„Çä„Éê„ÉÉ„Éï„Ç°„Çµ„Ç§„Ç∫„ÅÆÊ∏õÁÆó
    83                              <1> .20E:                   ;}
    84                              <1> 
    85                              <1> ;------------------------
    86                              <1> ;ASCIIÂ§âÊèõ
    87                              <1> ;divÂëΩ‰ª§ : „ÄêÂâ≤„ÇäÁÆó„Äë„ÅÆÁ≠î„Åà„Å®„Äê‰Ωô„Çä„Äë„ÅÆ„Åü„ÇÅ„Å´Âà•„ÄÖ„ÅÆ„É¨„Ç∏„Çπ„Çø„Å´Ê†ºÁ¥ç„Åï„Çå„Çã
    88                              <1> ;------------------------
    89                              <1> ;cmpÂëΩ‰ª§ : Á¨¨1„Ç™„Éö„É©„É≥„Éâ„Å®Á¨¨‰∫å„Ç™„Éö„É©„É≥„Éâ„ÅÆÂºï„ÅçÁÆó„Çí„Åó„Å¶„ÄÅÁµêÊûú„ÇíÁ†¥Ê£Ñ„ÅóÁµêÊûú„Å´Âü∫„Å•„ÅÑ„Å¶„Éï„É©„Ç∞„É¨„Ç∏„Çπ„Çø„Çí„Çª„ÉÉ„Éà„Åô„Çã
    90                              <1> ;loopnzÂëΩ‰ª§ : ECXÔºàCXÔºâ„Çí„Ç´„Ç¶„É≥„Çø„Å®„Åó„Å¶‰ΩøÁî®„Åó„Å¶„ÄÅ„É´„Éº„ÉóÊìç‰Ωú„ÇíÂÆüË°å 
    91                              <1> ;             „Éï„É©„Ç∞„É¨„Ç∏„Çπ„Çø„ÅÆÁä∂ÊÖã„Åå„ÄêZF=0„Äë„Åã„Å§„Ç´„Ç¶„É≥„Çø
    92                              <1> ;------------------------
    93 000001A7 8B5E0A              <1>     mov bx,[bp + 10]            ;BX = Âü∫Êï∞;
    94                              <1> .30L:                           ;do{
    95 000001AA BA0000              <1>     mov dx,0                    ;DX =0;
    96 000001AD F7F3                <1>     div bx                      ;DX = DX:AX % Âü∫Êï∞;
    97                              <1>                                 ;AX = DX:AX / Âü∫Êï∞;
    98 000001AF 89D6                <1>     mov si,dx                   ;„ÉÜ„Éº„Éñ„É´ÂèÇÁÖß
    99 000001B1 8A94[D901]          <1>     mov dl,byte[.ascii + si]    ;DL = ASCII[DX];
   100                              <1> 
   101 000001B5 8815                <1>     mov [di],dl                 ;*dst = DL;
   102 000001B7 4F                  <1>     dec di                      ;dst--;
   103                              <1> 
   104 000001B8 83F800              <1>     cmp ax,0                    ;ax(Â§âÊèõÂØæË±°)„ÅÆÂÄ§„Åå0„Åã„ÉÅ„Çß„ÉÉ„ÇØ
   105 000001BB E0ED                <1>     loopnz .30L                 ;}while(AX);
   106                              <1> .30E:
   107                              <1> 
   108                              <1> 
   109                              <1> ;--------------------------
   110                              <1> ;Á©∫Ê¨Ñ„ÇíÂüã„ÇÅ„Çã
   111                              <1> ;--------------------------
   112 000001BD 83F900              <1>     cmp cx,0                    ;if(size)
   113 000001C0 740D                <1> .40Q:   je  .40E                ;{
   114 000001C2 B020                <1>     mov al,' '                   ;   AL = '';// Á©∫ÁôΩ„ÅßÂüã„ÇÅ„Çã(„Éá„Éï„Ç©„É´„ÉàÂÄ§)
   115 000001C4 837E0C04            <1>     cmp [bp + 12],word 0b0100   ;   if(flags & 0x04)
   116 000001C8 7502                <1> .42Q:   jne .42E                ;   {
   117 000001CA B030                <1>     mov al,'0'                          ;AL = '0';
   118                              <1> .42E:                           ;   }
   119 000001CC FD                  <1>     std                         ;   DF = 1
   120 000001CD F3AA                <1>     rep stosb                   ;   while(--CX)*DI--='';
   121                              <1> .40E:                           ;}
   122                              <1> 
   123                              <1>     ;-------------------------------------
   124                              <1>     ;„Äê„É¨„Ç∏„Çπ„Çø„ÅÆ‰øùÂ≠ò„Äë
   125                              <1>     ;-------------------------------------
   126 000001CF 5F                  <1>     pop di
   127 000001D0 5E                  <1>     pop si
   128 000001D1 5A                  <1>     pop dx
   129 000001D2 59                  <1>     pop cx
   130 000001D3 5B                  <1>     pop bx
   131 000001D4 58                  <1>     pop ax
   132                              <1> 
   133                              <1>     ;-------------------------------------
   134                              <1>     ;„Äê„Çπ„Çø„ÉÉ„ÇØ„Éï„É¨„Éº„É†„ÅÆÁ†¥Ê£Ñ„Äë
   135                              <1>     ;-------------------------------------
   136 000001D5 89EC                <1>     mov sp,bp
   137 000001D7 5D                  <1>     pop bp
   138                              <1> 
   139 000001D8 C3                  <1>     ret
   140                              <1> 
   141                              <1> ;--------------------------
   142                              <1> ;Â§âÊèõ„ÉÜ„Éº„Éñ„É´
   143                              <1> ;dbÁñë‰ººÂëΩ‰ª§ : „Ç™„Éö„É©„É≥„Éâ„ÅßÊåáÂÆö„Åï„Çå„ÅüÂàùÊúüÂÄ§„ÅßÔºå„É°„É¢„É™„Çí„Éê„Ç§„ÉàÂçò‰Ωç„ÅßÂàùÊúüÂåñ
   144                              <1> ;--------------------------
   145 000001D9 303132333435363738- <1> .ascii db "0123456789ABCDEF"
   145 000001E2 39414243444546      <1>
    89                                  
    90                                  
    91                                  ;****************************************************
    92                                  ;ÅyÉuÅ[ÉgÉtÉâÉOÅz(êÊì™512ÉoÉCÉgÇÃèIóπ)
    93                                  ;****************************************************
    94 000001E9 00<rept>                times 510 - ($ - $$) db 0x00
    95 000001FE 55AA                    db 0x55,0xAA
